input {   beats {
        port => 5047
    } }

filter{
    mutate{      
        add_field=>{'HostName'=>'%{[host][name]}'}
        add_field =>{ 'source' => 'filebeat'}
        add_field=>{'date_type'=>'%{[input][type]}'}
        rename =>  {'message' => 'msg'}
        remove_field=>['log','input','agent','ecs','host']
    }
    clone {clones => ['clonA']}
  if([type] == "clonA"){
       grok {
        match=>{ 'msg' =>"%{IP:ip_cliente} %{USER:si} %{USER:ss} %{USERNAME:user} %{GREEDYDATA:resto}"}}
    }
  
  
}
output {
        if([type] == "clonA"){
        file {
            path => "/data/fileA"
        }
    }
    else{
        file {
            path => "/data/fileC"
        }

    }
    #if([type] == "clonA"){
    #http {
      #format=>"json"
      #http_method=>"post"
      #url=>"http://oip-endpoint1:8081"
   #}
                        #}
#else{
    #http {
      #format=>"json"
      #http_method=>"post"
      #url=>"http://oip-endpoint3:8083"
   #}

#}


}
        

    
    




  





